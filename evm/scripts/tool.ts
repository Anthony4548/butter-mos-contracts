import { BigNumber, ethers } from "ethers";
require('dotenv/config');

const mapProvider = new ethers.providers.JsonRpcProvider("http://18.142.54.137:7445", 212);
const mapSigner = new ethers.Wallet(process.env.PRIVATE_KEY!, mapProvider);

const ethProvider = new ethers.providers.JsonRpcProvider("http://18.138.248.113:8545", 34434);
const ethSigner = new ethers.Wallet(process.env.PRIVATE_KEY!, ethProvider);

const WMAPAbi = [
    "function deposit() public payable"
]

const tokenABI = [
    "function approve(address _spender, uint256 _value) public returns (bool success)",
    "function allowance(address owner, address spender) public view returns (uint256)"
]

async function main() {
    // console.log(await approve("0xE1b2b81B66150F9EF5A89dC346a7A8B8df05d847", "0x27A51306c2b727d068c1B6E9895c6d160Edd21B3", ethers.utils.parseEther("1000")));
    // await wrapMap("100");
    const b = [210,76,105,68,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,213,249,7,210,148,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,148,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,130,134,130,129,212,185,7,160,249,7,157,249,3,195,1,130,218,166,185,1,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,64,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,32,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,249,2,185,248,122,148,254,116,83,7,217,200,166,249,167,47,96,142,135,130,31,63,85,9,10,53,248,66,160,225,255,252,196,146,61,4,181,89,244,210,154,139,252,108,218,4,235,91,13,60,70,7,81,194,64,44,92,92,201,16,156,160,0,0,0,0,0,0,0,0,0,0,0,0,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,224,182,179,167,100,0,0,249,2,58,148,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,225,160,172,160,161,6,117,72,39,14,128,193,32,158,198,155,83,129,216,11,218,243,69,173,112,207,127,0,175,156,110,211,249,180,185,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,64,65,189,177,103,106,31,102,81,171,36,232,77,102,117,92,170,45,220,22,65,149,196,133,147,233,153,68,243,75,26,151,186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78,69,65,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,224,182,179,167,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,203,219,29,164,249,146,118,176,196,39,119,107,222,147,131,139,193,147,134,204,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,120,121,108,105,46,116,101,115,116,110,101,116,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,249,3,207,249,3,204,130,32,128,185,3,198,249,3,195,1,130,218,166,185,1,0,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,64,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,32,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,249,2,185,248,122,148,254,116,83,7,217,200,166,249,167,47,96,142,135,130,31,63,85,9,10,53,248,66,160,225,255,252,196,146,61,4,181,89,244,210,154,139,252,108,218,4,235,91,13,60,70,7,81,194,64,44,92,92,201,16,156,160,0,0,0,0,0,0,0,0,0,0,0,0,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,160,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,224,182,179,167,100,0,0,249,2,58,148,189,150,178,127,231,94,30,209,8,220,218,198,75,132,96,21,77,75,104,25,225,160,172,160,161,6,117,72,39,14,128,193,32,158,198,155,83,129,216,11,218,243,69,173,112,207,127,0,175,156,110,211,249,180,185,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,64,65,189,177,103,106,31,102,81,171,36,232,77,102,117,92,170,45,220,22,65,149,196,133,147,233,153,68,243,75,26,151,186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,134,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78,69,65,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,224,182,179,167,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,203,219,29,164,249,146,118,176,196,39,119,107,222,147,131,139,193,147,134,204,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,120,121,108,105,46,116,101,115,116,110,101,116,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,131,7,251,163,128,0,0,0,0,0,0,0,0,0,0,0]
    console.log(ethers.utils.hexlify(b));
    // const hex = "8c9b3cAf7DedD3003f53312779c1b92ba1625D94"
    // console.log(JSON.stringify(hexToDecimalArray(hex)))
}

function hexToDecimalArray(hex: string) {
    const res: number[] = [];

    for (let i = 0; i < hex.length; i = i+2) {
        res.push(parseInt(hex.substr(i, 2), 16));
    }

    return res

}
async function wrapMap(amount: string) {
    const WMAPContract = new ethers.Contract("0x13CB04d4a5Dfb6398Fc5AB005a6c84337256eE23", WMAPAbi, mapSigner);
    const r = await WMAPContract.deposit({value: ethers.utils.parseEther(amount)});
    console.log(r);
}

async function approve(tokenAddress: string, spender: string, amount: BigNumber) {
    const tokenContract = new ethers.Contract(tokenAddress, tokenABI, ethSigner);
    const success = await tokenContract.allowance("0xCBdb1Da4f99276b0c427776BDE93838Bc19386Cc", spender);
    return success;
}
main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
});